<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet", href="style.css">
    </head>
    <div id="main_container">
        <img id="gba_image" src="img/gba.png"/>
        <img id="cart_image" src="img/cart.png"/>
    </div>

</html>

<script>
    
    //primitives
    let rot = 0
    let rot_on_insert = 0;
    let x_on_insert = 0;
    function dist(x1,x2,y1,y2){
        return Math.sqrt(Math.pow((x1-x2),2)+Math.pow((y1-y2),2));
    }
    
    cart = {
        e : document.getElementById("cart_image"),
        get top() {return this.e.offsetTop},
        get bot() {return this.e.offsetTop + this.e.clientHeight},
        _rot : 0,
        set rot(val) {
            this.e.style.transform = "rotate("+val+"rad)";
            this._rot = val;
        },
        get rot() {return this._rot},
        get x() {return (this.e.offsetLeft + this.e.clientWidth/2)},    //pre-calc division?
        get y() {return (this.e.offsetTop + this.e.clientHeight/2)},
        set x(val) {this.e.style.left = (val - this.e.clientWidth/2)+"px"},
        set y(val) {this.e.style.top = (val - this.e.clientHeight/2)+"px"}
    }
    
    gba = {
        e : document.getElementById("gba_image"),
        get top() {return this.e.offsetTop},
        get x() {return (this.e.offsetLeft + this.e.clientWidth/2)},    //pre-calc division?
        get y() {return (this.e.offsetTop + this.e.clientHeight/2)},
        set x(val) {this.e.style.left = (val - this.e.clientWidth/2)+"px"},
        set y(val) {this.e.style.top = (val - this.e.clientHeight/2)+"px"}
    }
    container = document.getElementById("main_container");
    
    let cart_inserted = false;

    container.addEventListener("mousemove", (e) => {

        if(cart_inserted){
            cart.y = e.pageY; 
            //TODO:adjust x pos as inserting??
            cart.x = gba.x;
            //adjust rotation as inserting
            cart.rot = 0;
            if(cart.y < 100){
                cart_inserted = false;
            }
        }else{
            //trying to make the cart follow the cursor
            cart.x = e.pageX;
            cart.y = e.pageY;

            //calcing and applying rotation of cart
            opposite = gba.x  - e.pageX;
            adjacent = gba.y - e.pageY;
            cart.rot = -Math.atan(opposite/adjacent)
            if(cart.rot > -0.2 && cart.rot < 0.2 && cart.bot == gba.top){
                cart_inserted = true;
                rot_on_insert = cart.rot;
                x_on_insert = cart.x;
            }
        }
    }, false);

    


</script>
